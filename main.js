(()=>{"use strict";var e={138:(e,t,n)=>{n.d(t,{IK:()=>o,iQ:()=>d,m8:()=>s});const d=(e,t,n,d,o,s)=>({getTitle:()=>e,setTitle:t=>e=t,getDescription:()=>t,setDescription:e=>t=e,getDate:()=>n,setDate:e=>n=e,getPriority:()=>d,setPriority:e=>d=e,getStatus:()=>o,setStatus:e=>o=e,getId:()=>s,setId:e=>s=e}),o=(e,t)=>{let n=[];return{getTasks:()=>n,getProjectTitle:()=>e,getProjectId:()=>t,setProjectTitle:t=>e=t,setProjectId:e=>t=e,getTask:e=>n.find((t=>t.getId()===e)),addTask:e=>{n.push(e)},removeTask:e=>{n=n.filter((t=>t.getId()!==e))}}},s=()=>{let e=[];return{getProject:t=>e.find((e=>e.getProjectId()===t)),getProjects:()=>e,addProject:t=>{e.push(t)},removeProject:t=>{e=e.filter((e=>e.getProjectId()!==t))}}}},982:(e,t,n)=>{n.d(t,{B:()=>c,z:()=>a});const d=document.querySelectorAll("[data-modal-target]"),o=document.querySelectorAll("[data-close-button]"),s=document.getElementById("overlay");function c(e){null!=e&&(e.classList.add("active"),s.classList.add("active"))}function a(e){null!=e&&(e.classList.remove("active"),s.classList.remove("active"))}d.forEach((e=>{e.addEventListener("click",(()=>{c(document.querySelector(e.dataset.modalTarget))}))})),o.forEach((e=>{e.addEventListener("click",(()=>{a(e.closest(".form"))}))}))},658:(e,t,n)=>{var d=n(138),o=n(982);const s=(0,d.m8)();function c(){const e=u.value,t=self.crypto.randomUUID();return(0,d.IK)(e,t)}function a(e){const t=document.querySelector(".projects"),n=document.createElement("div");n.id=e.getProjectId();const d=document.getElementById("add-project");n.classList.add("project","high-light");const o=document.createElement("div");o.classList.add("project-title-div","high-light");const s=document.createElement("span");s.classList.add("project-title","high-light"),s.textContent=e.getProjectTitle();const c=document.createElement("input");c.classList.add("edit-project-title","hidden"),s.type="text";const a=document.createElement("div");a.classList.add("edit-project-buttons");const r=document.createElement("span");r.classList.add("edit-project","material-icons-outlined"),r.textContent="edit";const l=document.createElement("span");l.classList.add("delete-project","material-icons-outlined"),l.textContent="delete";const i=document.createElement("span");i.classList.add("edit-project-btn","material-icons-outlined","hidden"),i.textContent="check";const g=document.createElement("span");return g.classList.add("cancel-project-btn","material-icons-outlined","hidden"),g.textContent="cancel",n.append(o,a),o.append(s,c),a.append(r,l,i,g),t.insertBefore(n,d),n}const r=document.querySelector(".add-project"),l=document.getElementById("add-project"),i=document.querySelector(".set-new-project-btn"),g=document.querySelector(".cancel-new-project-btn"),u=document.getElementById("project-title-input");function m(){s.getProject(y).getTasks().forEach((e=>v(e)))}r.addEventListener("click",(()=>{l.classList.toggle("hidden"),r.classList.toggle("hidden")})),i.addEventListener("click",(()=>{const e=c();y=e.getProjectId(),s.addProject(e),a(e),l.classList.toggle("hidden"),r.classList.toggle("hidden"),u.value=""})),g.addEventListener("click",(()=>{l.classList.toggle("hidden"),r.classList.toggle("hidden"),u.value=""}));const p=document.querySelector(".projects"),h="\n    transform: scale(1.01);\n    transition: 0.2s;\n    box-shadow: 5px 5px 5px #bcbcbc;\n    ";let y,L;function v(e){const t=document.querySelector(".tasks"),n=document.createElement("div");n.classList.add("task"),n.id=e.getId(),n.dataset.project=y;const d=document.createElement("div");d.classList.add("first-task-elements"),"Low"==e.getPriority()?n.style.borderLeft="5px solid green":"Medium"==e.getPriority()?n.style.borderLeft="5px solid orange":n.style.borderLeft="5px solid red","Complete"==e.getStatus()?n.style.opacity="0.5":"Incomplete"==e.getStatus()&&(n.style.opactiy="1");const o=document.createElement("div");o.classList.add("title"),o.textContent=e.getTitle();const s=document.createElement("div");s.classList.add("last-task-elements");const c=document.createElement("button");c.textContent="Details",c.classList.add("details");const a=document.createElement("div");a.classList.add("due-date"),a.textContent=e.getDate();const r=document.createElement("span");r.classList.add("edit","material-icons-outlined"),r.textContent="edit";const l=document.createElement("span");l.classList.add("delete","material-icons-outlined"),l.textContent="delete",d.append(o),s.append(c,a,r,l),n.append(d,s),t.append(n)}p.addEventListener("click",(e=>{if(document.querySelectorAll(".task").forEach((e=>e.remove())),document.querySelectorAll(".project").forEach((e=>{e.classList.contains("high-light")&&(e.removeAttribute("style"),e.classList.remove("selected"))})),e.target.matches("div")&&e.target.classList.contains("project")?(e.target.style.cssText=h,e.target.classList.add("selected"),y=e.target.id,console.log(y),m()):e.target.matches("div")&&e.target.classList.contains("project-title-div")&&e.target.classList.contains("high-light")?(e.target.parentNode.style.cssText=h,e.target.parentNode.classList.add("selected"),y=e.target.parentNode.id,console.log(y),m()):e.target.matches("span")&&e.target.classList.contains("project-title")&&e.target.classList.contains("high-light")&&(e.target.parentNode.parentNode.style.cssText=h,e.target.parentNode.parentNode.classList.add("selected"),y=e.target.parentNode.parentNode.id,console.log(y),m()),e.target.matches("span")&&"delete"==e.target.textContent){const t=e.target.parentNode.parentNode,n=t.id;s.removeProject(n),t.remove()}if(e.target.matches("span")&&"edit"==e.target.textContent){e.target.parentNode.parentNode.style.cssText=h,e.target.parentNode.parentNode.classList.add("selected");const t=e.target.parentNode.parentNode.children[0].children[0],n=e.target.parentNode.parentNode.children[0].children[1];n.value=t.textContent;const d=e.target.parentNode.children[0],o=e.target.parentNode.children[1],s=e.target.parentNode.children[2],c=e.target.parentNode.children[3];t.classList.toggle("hidden"),n.classList.toggle("hidden"),d.classList.toggle("hidden"),o.classList.toggle("hidden"),s.classList.toggle("hidden"),c.classList.toggle("hidden")}if(e.target.matches("span")&&"check"==e.target.textContent){const t=e.target.parentNode.parentNode.id,n=s.getProject(t),d=e.target.parentNode.parentNode.children[0].children[0],o=e.target.parentNode.parentNode.children[0].children[1];n.setProjectTitle(o.value),d.textContent=n.getProjectTitle();const c=e.target.parentNode.children[0],a=e.target.parentNode.children[1],r=e.target.parentNode.children[2],l=e.target.parentNode.children[3];d.classList.toggle("hidden"),o.classList.toggle("hidden"),c.classList.toggle("hidden"),a.classList.toggle("hidden"),r.classList.toggle("hidden"),l.classList.toggle("hidden")}if(e.target.matches("span")&&"cancel"==e.target.textContent){e.target.parentNode.parentNode.style.cssText=h,e.target.parentNode.parentNode.classList.add("selected");const t=e.target.parentNode.parentNode.children[0].children[0],n=e.target.parentNode.parentNode.children[0].children[1],d=e.target.parentNode.children[0],o=e.target.parentNode.children[1],s=e.target.parentNode.children[2],c=e.target.parentNode.children[3];t.classList.toggle("hidden"),n.classList.toggle("hidden"),d.classList.toggle("hidden"),o.classList.toggle("hidden"),s.classList.toggle("hidden"),c.classList.toggle("hidden")}})),document.querySelector(".tasks").addEventListener("click",(e=>{if(e.target.matches("span")&&"edit"==e.target.textContent){const t=document.querySelector("#edit-form");(0,o.B)(t);const n=e.target.parentNode.parentNode.id,d=s.getProject(y).getTask(n);L=n;const c=document.getElementById("edit-title"),a=document.getElementById("edit-description"),r=document.getElementById("edit-due-date"),l=document.getElementById("edit-priority"),i=document.getElementById("edit-status");c.value=d.getTitle(),a.value=d.getDescription(),r.value=d.getDate(),l.value=d.getPriority(),"Complete"==d.getStatus()?i.checked=!0:i.checked=!1}else if(e.target.matches("span")&&"delete"==e.target.textContent){const t=e.target.parentNode.parentNode;console.log(s.getProject(y).getTasks()[0].getTitle()),s.getProject(y).removeTask(t.id),t.remove(),console.log(s.getProject(y).getTasks())}else if(e.target.matches("button")&&"Details"==e.target.textContent){const t=e.target.parentNode.parentNode.id,n=s.getProject(y).getTask(t),d=document.getElementById("task-title-output"),c=document.getElementById("task-due-date-output"),a=document.getElementById("task-priority-output"),r=document.getElementById("task-status-output"),l=document.getElementById("task-details-output");d.textContent=n.getTitle(),c.textContent=n.getDate(),a.textContent=n.getPriority(),r.textContent=n.getStatus(),l.textContent=n.getDescription();const i=document.getElementById("task-details");(0,o.B)(i),document.querySelectorAll("[data-close-button]").forEach((e=>{e.addEventListener("click",(()=>{const t=e.closest("#task-details");(0,o.z)(t)}))}))}}));const E=document.querySelector(".add-task"),j=document.querySelector(".edit-task");E.addEventListener("click",(e=>{e.preventDefault();const t=function(){const e=s.getProject(y),t=document.getElementById("title").value,n=document.getElementById("description").value,o=document.getElementById("due-date").value,c=document.getElementById("priority").value;let a;a=document.getElementById("status").checked?"Complete":"Incomplete";const r=self.crypto.randomUUID(),l=(0,d.iQ)(t,n,o,c,a,r);return e.addTask(l),l}();v(t),document.querySelector(".form-card").reset();const n=document.getElementById("due-date"),o=(new Date).toISOString().slice(0,10);n.value=o})),j.addEventListener("click",(e=>{e.preventDefault(),function(){const e=s.getProject(y).getTask(L),t=document.getElementById("edit-title").value,n=document.getElementById("edit-description").value,d=document.getElementById("edit-due-date").value,o=document.getElementById("edit-priority").value,c=document.getElementById("edit-status").checked;e.setTitle(t),e.setDescription(n),e.setDate(d),e.setPriority(o),c?e.setStatus("Complete"):e.setStatus("Incomplete")}(),function(e){const t=document.getElementById(e),n=s.getProject(y).getTask(e);t.childNodes[0].textContent=n.getTitle(),"Low"==n.getPriority()?t.style.borderLeft="5px solid green":"Medium"==n.getPriority()?t.style.borderLeft="5px solid orange":t.style.borderLeft="5px solid red","Complete"==n.getStatus()?t.style.opacity="0.5":"Incomplete"==n.getStatus()&&(t.style.opacity="1"),t.childNodes[1].childNodes[1].textContent=n.getDate(),console.log(n.getTitle())}(L)}));const N=document.getElementById("due-date"),I=(new Date).toISOString().slice(0,10);N.value=I;const f=c();f.setProjectTitle("Default Project"),s.addProject(f);const x=a(f);y=f.getProjectId(),x.id=y,x.classList.add("selected"),x.style.cssText=h}},t={};function n(d){var o=t[d];if(void 0!==o)return o.exports;var s=t[d]={exports:{}};return e[d](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var d in t)n.o(t,d)&&!n.o(e,d)&&Object.defineProperty(e,d,{enumerable:!0,get:t[d]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(138),n(658),n(982)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWFFLFFBR3JCLElBQUlDLEVBQVNOLEVBQXlCRSxHQUFZLENBR2pERyxRQUFTLElBT1YsT0FIQUUsRUFBb0JMLEdBQVVJLEVBQVFBLEVBQU9ELFFBQVNKLEdBRy9DSyxFQUFPRCxRQ3BCZkosRUFBb0JPLEVBQUksQ0FBQ0gsRUFBU0ksS0FDakMsSUFBSSxJQUFJQyxLQUFPRCxFQUNYUixFQUFvQlUsRUFBRUYsRUFBWUMsS0FBU1QsRUFBb0JVLEVBQUVOLEVBQVNLLElBQzVFRSxPQUFPQyxlQUFlUixFQUFTSyxFQUFLLENBQUVJLFlBQVksRUFBTUMsSUFBS04sRUFBV0MsTUNKM0VULEVBQW9CVSxFQUFJLENBQUNLLEVBQUtDLElBQVVMLE9BQU9NLFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEdDR2xGaEIsRUFBb0IsS0FDcEJBLEVBQW9CLEtBQ01BLEVBQW9CLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90by1kby8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy9tb2RhbC5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy90YXNrLXVzZXItaW50ZXJmYWNlLmpzIiwid2VicGFjazovL3RvLWRvL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RvLWRvL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly90by1kby93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3RvLWRvL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBUYXNrID0gKHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJpb3JpdHksIHN0YXR1cywgaWQpID0+IHtcblxuICAgIGNvbnN0IGdldFRpdGxlID0gKCkgPT4gdGl0bGU7XG4gICAgY29uc3Qgc2V0VGl0bGUgPSBuZXdUaXRsZSA9PiB0aXRsZSA9IG5ld1RpdGxlO1xuICAgIGNvbnN0IGdldERlc2NyaXB0aW9uID0gKCkgPT4gZGVzY3JpcHRpb247XG4gICAgY29uc3Qgc2V0RGVzY3JpcHRpb249IG5ld0Rlc2NyaXB0aW9uID0+IGRlc2NyaXB0aW9uID0gbmV3RGVzY3JpcHRpb247XG4gICAgY29uc3QgZ2V0RGF0ZSA9ICgpID0+IGR1ZURhdGU7XG4gICAgY29uc3Qgc2V0RGF0ZSA9IG5ld0RhdGUgPT4gZHVlRGF0ZSA9IG5ld0RhdGU7XG4gICAgY29uc3QgZ2V0UHJpb3JpdHkgPSAoKSA9PiBwcmlvcml0eTtcbiAgICBjb25zdCBzZXRQcmlvcml0eSA9IG5ld1ByaW9yaXR5ID0+IHByaW9yaXR5ID0gbmV3UHJpb3JpdHk7XG4gICAgY29uc3QgZ2V0U3RhdHVzID0gKCkgPT4gc3RhdHVzO1xuICAgIGNvbnN0IHNldFN0YXR1cyA9IG5ld1N0YXR1cyA9PiBzdGF0dXMgPSBuZXdTdGF0dXM7XG4gICAgY29uc3QgZ2V0SWQgPSAoKSA9PiBpZDtcbiAgICBjb25zdCBzZXRJZCA9IG5ld0lkID0+IGlkID0gbmV3SWQ7XG5cbiAgICByZXR1cm4ge2dldFRpdGxlLCBzZXRUaXRsZSwgZ2V0RGVzY3JpcHRpb24sIHNldERlc2NyaXB0aW9uLCBnZXREYXRlLCBzZXREYXRlLCBnZXRQcmlvcml0eSwgc2V0UHJpb3JpdHksIGdldFN0YXR1cywgc2V0U3RhdHVzLCBnZXRJZCwgc2V0SWR9XG59O1xuXG5cbmNvbnN0IFByb2plY3QgPSAocHJvamVjdFRpdGxlLCBwcm9qZWN0SWQpID0+IHtcblxuICAgIGxldCBwcm9qZWN0ID0gW107XG5cbiAgICBjb25zdCBnZXRQcm9qZWN0VGl0bGUgPSAoKSA9PiBwcm9qZWN0VGl0bGU7XG4gICAgY29uc3Qgc2V0UHJvamVjdFRpdGxlID0gbmV3VGl0bGUgPT4gcHJvamVjdFRpdGxlID0gbmV3VGl0bGU7XG4gICAgY29uc3QgZ2V0UHJvamVjdElkID0gKCkgPT4gcHJvamVjdElkO1xuICAgIGNvbnN0IHNldFByb2plY3RJZCA9IG5ld0lkID0+IHByb2plY3RJZCA9IG5ld0lkO1xuXG4gICAgY29uc3QgZ2V0VGFzayA9IChpZCkgPT4ge1xuICAgICAgICByZXR1cm4gcHJvamVjdC5maW5kKCh0YXNrKSA9PiB0YXNrLmdldElkKCkgPT09IGlkKVxuICAgIH07XG5cbiAgICBjb25zdCBnZXRUYXNrcyA9ICgpID0+IHByb2plY3Q7XG5cbiAgICBjb25zdCBhZGRUYXNrID0gKHRhc2spID0+IHtcbiAgICAgICAgcHJvamVjdC5wdXNoKHRhc2spXG4gICAgfTtcblxuICAgIGNvbnN0IHJlbW92ZVRhc2sgPSAoaWQpID0+IHtcbiAgICAgICAgcHJvamVjdCA9IHByb2plY3QuZmlsdGVyKCh0YXNrKSA9PiB0YXNrLmdldElkKCkgIT09IGlkKVxuICAgIH07XG5cbiAgICByZXR1cm4ge2dldFRhc2tzLCBnZXRQcm9qZWN0VGl0bGUsIGdldFByb2plY3RJZCwgc2V0UHJvamVjdFRpdGxlLCBzZXRQcm9qZWN0SWQsIGdldFRhc2ssIGFkZFRhc2ssIHJlbW92ZVRhc2t9XG59O1xuXG5cbmNvbnN0IFRvRG8gPSAoKSA9PiB7XG4gICAgXG4gICAgbGV0IHRvRG8gPSBbXTtcbiAgICBcbiAgICBjb25zdCBnZXRQcm9qZWN0ID0gKHByb2plY3RJZCkgPT4ge1xuICAgICAgICByZXR1cm4gdG9Eby5maW5kKChwcm9qZWN0KSA9PiBwcm9qZWN0LmdldFByb2plY3RJZCgpID09PSBwcm9qZWN0SWQpXG4gICAgfTtcblxuICAgIGNvbnN0IGdldFByb2plY3RzID0gKCkgPT4gdG9EbztcblxuICAgIGNvbnN0IGFkZFByb2plY3QgPSAocHJvamVjdCkgPT4ge1xuICAgICAgICB0b0RvLnB1c2gocHJvamVjdClcbiAgICB9O1xuXG4gICAgY29uc3QgcmVtb3ZlUHJvamVjdCA9IChwcm9qZWN0SWQpID0+IHtcbiAgICAgICAgdG9EbyA9IHRvRG8uZmlsdGVyKChwcm9qZWN0KSA9PiBwcm9qZWN0LmdldFByb2plY3RJZCgpICE9PSBwcm9qZWN0SWQpXG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge2dldFByb2plY3QsIGdldFByb2plY3RzLCBhZGRQcm9qZWN0LCByZW1vdmVQcm9qZWN0fVxufTtcblxuZXhwb3J0IHtUYXNrLCBQcm9qZWN0LCBUb0RvfSIsImNvbnN0IG9wZW5Nb2RhbEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtbW9kYWwtdGFyZ2V0XVwiKTtcbmNvbnN0IGNsb3NlTW9kYWxCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLWNsb3NlLWJ1dHRvbl1cIik7XG5jb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdmVybGF5XCIpO1xuXG5vcGVuTW9kYWxCdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYnV0dG9uLmRhdGFzZXQubW9kYWxUYXJnZXQpO1xuICAgICAgICBvcGVuRm9ybShmb3JtKTtcbiAgICB9KVxufSkgXG5cbmNsb3NlTW9kYWxCdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgY29uc3QgZm9ybSA9IGJ1dHRvbi5jbG9zZXN0KFwiLmZvcm1cIilcbiAgICAgICAgY2xvc2VGb3JtKGZvcm0pO1xuICAgIH0pXG59KVxuXG5mdW5jdGlvbiBvcGVuRm9ybShmb3JtKSB7XG4gICAgaWYgKGZvcm0gPT0gbnVsbCkgcmV0dXJuXG4gICAgZm9ybS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VGb3JtKGZvcm0pIHtcbiAgICBpZiAoZm9ybSA9PSBudWxsKSByZXR1cm5cbiAgICBmb3JtLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xufVxuXG5leHBvcnQge29wZW5Gb3JtLCBjbG9zZUZvcm19IiwiaW1wb3J0IHtUYXNrLCBQcm9qZWN0LCBUb0RvfSBmcm9tICcuL2luZGV4J1xuaW1wb3J0IHtvcGVuRm9ybSwgY2xvc2VGb3JtfSBmcm9tICcuL21vZGFsJ1xuXG4vLyBQcm9qZWN0IFVJXG5cbmNvbnN0IHRvRG9MaXN0ID0gVG9EbygpXG5cbi8vIFByb2plY3QgVUlcblxuZnVuY3Rpb24gY3JlYXRlUHJvamVjdCgpIHtcbiAgIGNvbnN0IHByb2plY3RUaXRsZSA9IHByb2plY3RUaXRsZUlucHV0LnZhbHVlXG4gICBjb25zdCBwcm9qZWN0SWQgPSBzZWxmLmNyeXB0by5yYW5kb21VVUlEKCk7XG5cbiAgIGNvbnN0IG5ld1Byb2plY3QgPSBQcm9qZWN0KHByb2plY3RUaXRsZSwgcHJvamVjdElkKVxuICAgcmV0dXJuIG5ld1Byb2plY3Rcbn1cblxuZnVuY3Rpb24gY3JlYXRlUHJvamVjdFVJKHByb2plY3QpIHtcbiAgICBjb25zdCBwcm9qZWN0c0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdHNcIilcbiAgICBjb25zdCBwcm9qZWN0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBwcm9qZWN0RGl2LmlkID0gcHJvamVjdC5nZXRQcm9qZWN0SWQoKVxuXG4gICAgY29uc3QgYWRkUHJvamVjdERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLXByb2plY3RcIilcbiAgICBwcm9qZWN0RGl2LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QnLCAnaGlnaC1saWdodCcpXG5cbiAgICBjb25zdCBwcm9qZWN0VGl0bGVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHByb2plY3RUaXRsZURpdi5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC10aXRsZS1kaXZcIiwgXCJoaWdoLWxpZ2h0XCIpXG5cbiAgICBjb25zdCBwcm9qZWN0VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBwcm9qZWN0VGl0bGUuY2xhc3NMaXN0LmFkZChcInByb2plY3QtdGl0bGVcIiwgXCJoaWdoLWxpZ2h0XCIpXG4gICAgcHJvamVjdFRpdGxlLnRleHRDb250ZW50ID0gcHJvamVjdC5nZXRQcm9qZWN0VGl0bGUoKVxuXG4gICAgY29uc3QgcHJvamVjdFRpdGxlSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgcHJvamVjdFRpdGxlSW5wdXQuY2xhc3NMaXN0LmFkZChcImVkaXQtcHJvamVjdC10aXRsZVwiLCBcImhpZGRlblwiKVxuICAgIHByb2plY3RUaXRsZS50eXBlID0gXCJ0ZXh0XCJcblxuICAgIGNvbnN0IHByb2plY3RFZGl0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBwcm9qZWN0RWRpdERpdi5jbGFzc0xpc3QuYWRkKFwiZWRpdC1wcm9qZWN0LWJ1dHRvbnNcIilcblxuICAgIGNvbnN0IGVkaXRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBlZGl0QnRuLmNsYXNzTGlzdC5hZGQoXCJlZGl0LXByb2plY3RcIiwgXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiKVxuICAgIGVkaXRCdG4udGV4dENvbnRlbnQgPSAnZWRpdCdcblxuICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlLXByb2plY3RcIiwgXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiKVxuICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9ICdkZWxldGUnXG5cbiAgICBjb25zdCBjaGVja0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgIGNoZWNrQnRuLmNsYXNzTGlzdC5hZGQoXCJlZGl0LXByb2plY3QtYnRuXCIsIFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIiwgXCJoaWRkZW5cIilcbiAgICBjaGVja0J0bi50ZXh0Q29udGVudCA9ICdjaGVjaydcblxuICAgIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgIGNhbmNlbEJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FuY2VsLXByb2plY3QtYnRuXCIsIFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIiwgXCJoaWRkZW5cIilcbiAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSAnY2FuY2VsJ1xuXG4gICAgcHJvamVjdERpdi5hcHBlbmQocHJvamVjdFRpdGxlRGl2LCBwcm9qZWN0RWRpdERpdilcbiAgICBwcm9qZWN0VGl0bGVEaXYuYXBwZW5kKHByb2plY3RUaXRsZSwgcHJvamVjdFRpdGxlSW5wdXQpXG4gICAgcHJvamVjdEVkaXREaXYuYXBwZW5kKGVkaXRCdG4sIGRlbGV0ZUJ0biwgY2hlY2tCdG4sIGNhbmNlbEJ0bilcbiAgICBwcm9qZWN0c0NvbnRhaW5lci5pbnNlcnRCZWZvcmUocHJvamVjdERpdiwgYWRkUHJvamVjdERpdilcblxuICAgIHJldHVybiBwcm9qZWN0RGl2XG59XG5cblxuLy8gQWRkIFByb2plY3QgRXZlbnQgTGlzdGVuZXJzXG5jb25zdCBhZGRQcm9qZWN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1wcm9qZWN0JylcbmNvbnN0IGFkZFByb2plY3REaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkLXByb2plY3QnKVxuY29uc3Qgc2V0UHJvamVjdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2V0LW5ldy1wcm9qZWN0LWJ0blwiKVxuY29uc3QgY2FuY2VsUHJvamVjdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FuY2VsLW5ldy1wcm9qZWN0LWJ0blwiKVxuY29uc3QgcHJvamVjdFRpdGxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2plY3QtdGl0bGUtaW5wdXRcIilcblxuYWRkUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBhZGRQcm9qZWN0RGl2LmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpXG4gICAgYWRkUHJvamVjdEJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKVxufSlcblxuc2V0UHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjb25zdCBuZXdQcm9qZWN0ID0gY3JlYXRlUHJvamVjdCgpXG4gICAgcHJvamVjdERpdklkID0gbmV3UHJvamVjdC5nZXRQcm9qZWN0SWQoKVxuICAgIHRvRG9MaXN0LmFkZFByb2plY3QobmV3UHJvamVjdClcbiAgICBjcmVhdGVQcm9qZWN0VUkobmV3UHJvamVjdClcbiAgICBhZGRQcm9qZWN0RGl2LmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpXG4gICAgYWRkUHJvamVjdEJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKVxuICAgIHByb2plY3RUaXRsZUlucHV0LnZhbHVlID0gJydcbn0pXG5cbmNhbmNlbFByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgYWRkUHJvamVjdERpdi5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKVxuICAgIGFkZFByb2plY3RCdG4uY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJylcbiAgICBwcm9qZWN0VGl0bGVJbnB1dC52YWx1ZSA9ICcnXG59KVxuXG5cbi8vIER5bmFtaWMgUHJvamVjdCBFdmVudCBMaXN0ZW5lcnNcbmZ1bmN0aW9uIHJlbW92ZVByb2plY3RTdHlsaW5ncygpIHtcbiAgICBjb25zdCBwcm9qZWN0RGl2cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9qZWN0JylcbiAgICBwcm9qZWN0RGl2cy5mb3JFYWNoKGUgPT4ge1xuICAgICAgICBpZiAoZS5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZ2gtbGlnaHQnKSkge1xuICAgICAgICAgICAgZS5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJylcbiAgICAgICAgICAgIGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gcmVtb3ZlVGFza3MoKSB7XG4gICAgY29uc3QgdGFza0RpdnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzaycpXG4gICAgdGFza0RpdnMuZm9yRWFjaChlID0+IGUucmVtb3ZlKCkpXG59XG4gICAgXG4vLyBmdW5jdGlvbiByZW5kZXJQcm9qZWN0VGFza3MoKSB7XG4vLyAgICAgY29uc3QgdGFza0FycmF5ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFza3MnKS5jaGlsZHJlbilcbi8vICAgICBsZXQgdGFza0lkQXJyYXkgPSBbXVxuLy8gICAgIHRhc2tBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7XG4vLyAgICAgICAgIGlmICghdGFza0lkQXJyYXkuaW5jbHVkZXMoaXRlbS5kYXRhc2V0LnByb2plY3QpKSB7XG4vLyAgICAgICAgIHRhc2tJZEFycmF5LnB1c2goKGl0ZW0uZGF0YXNldC5wcm9qZWN0KSl9fVxuLy8gICAgICAgICApXG4vLyAgICAgY29uc3Qgbm90aW5Qcm9qZWN0ID0gdGFza0lkQXJyYXkuZmlsdGVyKChlbGVtZW50KSA9PiBlbGVtZW50ICE9PSBwcm9qZWN0RGl2SWQpXG4vLyAgICAgY29uc29sZS5sb2cobm90aW5Qcm9qZWN0KVxuLy8gICAgIG5vdGluUHJvamVjdC5mb3JFYWNoKGl0ZW0gPT4ge1xuLy8gICAgICAgICBjb25zdCBkaXZzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtcHJvamVjdD1cIiR7aXRlbX1cIl1gKVxuLy8gICAgICAgICBkaXZzLmZvckVhY2goaXRlbSA9PiBpdGVtLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJylcbi8vICAgICAgICAgfSlcbi8vIH1cblxuZnVuY3Rpb24gcmVuZGVyUHJvamVjdHNUYXNrc0JldHRlcigpIHtcbiAgICBjb25zdCBwcm9qZWN0VGFza3MgPSB0b0RvTGlzdC5nZXRQcm9qZWN0KHByb2plY3REaXZJZCkuZ2V0VGFza3MoKVxuICAgIHByb2plY3RUYXNrcy5mb3JFYWNoKCh0YXNrKSA9PiBjcmVhdGVUYXNrVUkodGFzaykpXG59XG5cbmNvbnN0IHByb2plY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJylcbmNvbnN0IHByb2plY3RTdHlsZSA9IGBcbiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDEpO1xuICAgIHRyYW5zaXRpb246IDAuMnM7XG4gICAgYm94LXNoYWRvdzogNXB4IDVweCA1cHggI2JjYmNiYztcbiAgICBgXG5cbmxldCBwcm9qZWN0RGl2SWQgXG5cbnByb2plY3RzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblxuICAgIC8vIEhvdmVyIC8gU2VsZWN0aW9uIHN0eWxpbmdcbiAgICByZW1vdmVUYXNrcygpXG4gICAgcmVtb3ZlUHJvamVjdFN0eWxpbmdzKClcbiAgICBpZiAoZS50YXJnZXQubWF0Y2hlcyhcImRpdlwiKSAmJiBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3Byb2plY3QnKSkge1xuICAgICAgICBlLnRhcmdldC5zdHlsZS5jc3NUZXh0ID0gcHJvamVjdFN0eWxlXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgICAgcHJvamVjdERpdklkID0gZS50YXJnZXQuaWRcbiAgICAgICAgY29uc29sZS5sb2cocHJvamVjdERpdklkKVxuXG4gICAgICAgIC8vIFJlbmRlciBwcm9qZWN0IHRhc2tzXG4gICAgICAgIC8vIHJlbmRlclByb2plY3RUYXNrcygpXG4gICAgICAgIHJlbmRlclByb2plY3RzVGFza3NCZXR0ZXIoKVxuICAgICAgICBcbiAgICB9IGVsc2UgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCJkaXZcIikgJiYgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwcm9qZWN0LXRpdGxlLWRpdicpICYmIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGlnaC1saWdodCcpKSB7XG4gICAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUuc3R5bGUuY3NzVGV4dCA9IHByb2plY3RTdHlsZVxuICAgICAgICBlLnRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgICAgcHJvamVjdERpdklkID0gZS50YXJnZXQucGFyZW50Tm9kZS5pZFxuICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0RGl2SWQpXG5cbiAgICAgICAgLy8gUmVuZGVyIHByb2plY3QgdGFza3NcbiAgICAgICAgLy8gcmVuZGVyUHJvamVjdFRhc2tzKClcbiAgICAgICAgcmVuZGVyUHJvamVjdHNUYXNrc0JldHRlcigpXG5cbiAgICB9IGVsc2UgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCJzcGFuXCIpICYmIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncHJvamVjdC10aXRsZScpICYmIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGlnaC1saWdodCcpKSB7XG4gICAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5zdHlsZS5jc3NUZXh0ID0gcHJvamVjdFN0eWxlXG4gICAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgICAgIHByb2plY3REaXZJZCA9IGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pZFxuICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0RGl2SWQpXG5cbiAgICAgICAgLy8gUmVuZGVyIHByb2plY3QgdGFza3NcbiAgICAgICAgLy8gcmVuZGVyUHJvamVjdFRhc2tzKClcbiAgICAgICAgcmVuZGVyUHJvamVjdHNUYXNrc0JldHRlcigpXG4gICAgfVxuXG4gICAgLy8gRGVsZXRlIFByb2plY3RcblxuICAgIGlmIChlLnRhcmdldC5tYXRjaGVzKFwic3BhblwiKSAmJiBlLnRhcmdldC50ZXh0Q29udGVudCA9PSAnZGVsZXRlJykge1xuXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGVcbiAgICAgICAgY29uc3QgcHJvamVjdElkID0gcHJvamVjdC5pZFxuICAgICAgICB0b0RvTGlzdC5yZW1vdmVQcm9qZWN0KHByb2plY3RJZClcbiAgICAgICAgcHJvamVjdC5yZW1vdmUoKVxuICAgIH1cblxuICAgIC8vIEVkaXQgUHJvamVjdFxuICAgIGlmIChlLnRhcmdldC5tYXRjaGVzKFwic3BhblwiKSAmJiBlLnRhcmdldC50ZXh0Q29udGVudCA9PSAnZWRpdCcpIHtcblxuICAgICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc3R5bGUuY3NzVGV4dCA9IHByb2plY3RTdHlsZVxuICAgICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuXG4gICAgICAgIGNvbnN0IHRpdGxlID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdXG4gICAgICAgIGNvbnN0IGlucHV0ID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzFdXG4gICAgICAgIGlucHV0LnZhbHVlID0gdGl0bGUudGV4dENvbnRlbnRcblxuICAgICAgICBjb25zdCBlZGl0QnRuID0gZS50YXJnZXQucGFyZW50Tm9kZS5jaGlsZHJlblswXVxuICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzFdXG4gICAgICAgIGNvbnN0IGVkaXRQcm9qZWN0QnRuID0gZS50YXJnZXQucGFyZW50Tm9kZS5jaGlsZHJlblsyXVxuICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzNdXG5cbiAgICAgICAgdGl0bGUuY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBpbnB1dC5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpXG4gICAgICAgIGVkaXRCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBkZWxldGVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBlZGl0UHJvamVjdEJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpXG4gICAgICAgIGNhbmNlbEJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpXG4gICAgfVxuXG4gICAgLy8gRWRpdCBQcm9qZWN0IFRpdGxlXG4gICAgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCJzcGFuXCIpICYmIGUudGFyZ2V0LnRleHRDb250ZW50ID09ICdjaGVjaycpIHtcblxuICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaWRcbiAgICAgICAgY29uc3QgcHJvamVjdCA9IHRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdElkKVxuICAgICAgICBcbiAgICAgICAgY29uc3QgdGl0bGUgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF1cbiAgICAgICAgY29uc3QgaW5wdXQgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMV1cbiAgICAgICAgcHJvamVjdC5zZXRQcm9qZWN0VGl0bGUoaW5wdXQudmFsdWUpXG4gICAgICAgIHRpdGxlLnRleHRDb250ZW50ID0gcHJvamVjdC5nZXRQcm9qZWN0VGl0bGUoKVxuXG4gICAgICAgIGNvbnN0IGVkaXRCdG4gPSBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzBdO1xuICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzFdO1xuICAgICAgICBjb25zdCBlZGl0UHJvamVjdEJ0biA9IGUudGFyZ2V0LnBhcmVudE5vZGUuY2hpbGRyZW5bMl07XG4gICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IGUudGFyZ2V0LnBhcmVudE5vZGUuY2hpbGRyZW5bM107XG5cbiAgICAgICAgdGl0bGUuY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBpbnB1dC5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpXG4gICAgICAgIGVkaXRCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBkZWxldGVCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBlZGl0UHJvamVjdEJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpXG4gICAgICAgIGNhbmNlbEJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpXG4gICAgfVxuXG4gICAgLy8gQ2FuY2VsIEVkaXRcbiAgICBpZiAoZS50YXJnZXQubWF0Y2hlcyhcInNwYW5cIikgJiYgZS50YXJnZXQudGV4dENvbnRlbnQgPT0gJ2NhbmNlbCcpIHtcblxuICAgICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc3R5bGUuY3NzVGV4dCA9IHByb2plY3RTdHlsZVxuICAgICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuICAgIFxuICAgICAgICBjb25zdCB0aXRsZSA9IGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZHJlblswXS5jaGlsZHJlblswXVxuICAgICAgICBjb25zdCBpbnB1dCA9IGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZHJlblswXS5jaGlsZHJlblsxXVxuICAgICAgICBjb25zdCBlZGl0QnRuID0gZS50YXJnZXQucGFyZW50Tm9kZS5jaGlsZHJlblswXTtcbiAgICAgICAgY29uc3QgZGVsZXRlQnRuID0gZS50YXJnZXQucGFyZW50Tm9kZS5jaGlsZHJlblsxXTtcbiAgICAgICAgY29uc3QgZWRpdFByb2plY3RCdG4gPSBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzJdO1xuICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSBlLnRhcmdldC5wYXJlbnROb2RlLmNoaWxkcmVuWzNdO1xuXG4gICAgICAgIHRpdGxlLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIilcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBlZGl0QnRuLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIilcbiAgICAgICAgZGVsZXRlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIilcbiAgICAgICAgZWRpdFByb2plY3RCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKVxuICAgICAgICBjYW5jZWxCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKX1cbn0pXG5cbi8vIFRhc2sgVUlcblxuZnVuY3Rpb24gY3JlYXRlVGFzaygpIHtcbiAgICBjb25zdCBwcm9qZWN0ID0gdG9Eb0xpc3QuZ2V0UHJvamVjdChwcm9qZWN0RGl2SWQpXG4gICAgY29uc3QgdGFza1RpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpdGxlJykudmFsdWVcbiAgICBjb25zdCB0YXNrRGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKS52YWx1ZVxuICAgIGNvbnN0IHRhc2tEYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1ZS1kYXRlJykudmFsdWVcbiAgICBjb25zdCB0YXNrUHJpb3JpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJpb3JpdHknKS52YWx1ZVxuICAgIGNvbnN0IHRhc2tDaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0dXMnKS5jaGVja2VkXG4gICAgbGV0IHRhc2tTdGF0dXNcbiAgICBpZiAodGFza0NoZWNrYm94KSB7XG4gICAgICAgIHRhc2tTdGF0dXMgPSAnQ29tcGxldGUnXG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGFza1N0YXR1cyA9ICdJbmNvbXBsZXRlJ1xuICAgIH1cbiAgICBjb25zdCB0YXNrSWQgPSBzZWxmLmNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgY29uc3QgbmV3VGFzayA9IFRhc2sodGFza1RpdGxlLCB0YXNrRGVzY3JpcHRpb24sIHRhc2tEYXRlLCB0YXNrUHJpb3JpdHksIHRhc2tTdGF0dXMsIHRhc2tJZClcbiAgICBwcm9qZWN0LmFkZFRhc2sobmV3VGFzaylcblxuICAgIHJldHVybiBuZXdUYXNrXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVRhc2soKSB7XG4gICAgY29uc3QgdGFza1RvRWRpdCA9IHRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdERpdklkKS5nZXRUYXNrKHRhc2tJZClcbiAgICBjb25zdCB0YXNrVGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdC10aXRsZScpLnZhbHVlXG4gICAgY29uc3QgdGFza0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXQtZGVzY3JpcHRpb24nKS52YWx1ZVxuICAgIGNvbnN0IHRhc2tEYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXQtZHVlLWRhdGUnKS52YWx1ZVxuICAgIGNvbnN0IHRhc2tQcmlvcml0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LXByaW9yaXR5JykudmFsdWVcbiAgICBjb25zdCB0YXNrQ2hlY2tib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdC1zdGF0dXMnKS5jaGVja2VkXG5cbiAgICB0YXNrVG9FZGl0LnNldFRpdGxlKHRhc2tUaXRsZSlcbiAgICB0YXNrVG9FZGl0LnNldERlc2NyaXB0aW9uKHRhc2tEZXNjcmlwdGlvbilcbiAgICB0YXNrVG9FZGl0LnNldERhdGUodGFza0RhdGUpXG4gICAgdGFza1RvRWRpdC5zZXRQcmlvcml0eSh0YXNrUHJpb3JpdHkpXG4gICAgaWYgKHRhc2tDaGVja2JveCkge1xuICAgICAgICB0YXNrVG9FZGl0LnNldFN0YXR1cygnQ29tcGxldGUnKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRhc2tUb0VkaXQuc2V0U3RhdHVzKCdJbmNvbXBsZXRlJylcbiAgICB9IFxufVxuXG5mdW5jdGlvbiBjcmVhdGVUYXNrVUkodGFzaykge1xuICAgIGNvbnN0IHRhc2tzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrc1wiKVxuICAgIGNvbnN0IHRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0YXNrRGl2LmNsYXNzTGlzdC5hZGQoXCJ0YXNrXCIpXG4gICAgdGFza0Rpdi5pZCA9IHRhc2suZ2V0SWQoKVxuICAgIHRhc2tEaXYuZGF0YXNldC5wcm9qZWN0ID0gcHJvamVjdERpdklkXG5cbiAgICBjb25zdCBmaXJzdFRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBmaXJzdFRhc2tEaXYuY2xhc3NMaXN0LmFkZChcImZpcnN0LXRhc2stZWxlbWVudHNcIilcblxuICAgIGlmICh0YXNrLmdldFByaW9yaXR5KCkgPT0gJ0xvdycpIHtcbiAgICAgICAgdGFza0Rpdi5zdHlsZS5ib3JkZXJMZWZ0ID0gJzVweCBzb2xpZCBncmVlbic7XG4gICAgfSBlbHNlIGlmICh0YXNrLmdldFByaW9yaXR5KCkgPT0gJ01lZGl1bScpIHtcbiAgICAgICAgdGFza0Rpdi5zdHlsZS5ib3JkZXJMZWZ0ID0gJzVweCBzb2xpZCBvcmFuZ2UnXG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGFza0Rpdi5zdHlsZS5ib3JkZXJMZWZ0ID0gJzVweCBzb2xpZCByZWQnXG4gICAgfVxuXG4gICAgaWYgKHRhc2suZ2V0U3RhdHVzKCkgPT0gJ0NvbXBsZXRlJykge1xuICAgICAgICB0YXNrRGl2LnN0eWxlLm9wYWNpdHkgPSAnMC41J1xuICAgIH0gZWxzZSBpZiAodGFzay5nZXRTdGF0dXMoKSA9PSAnSW5jb21wbGV0ZScpIHtcbiAgICAgICAgdGFza0Rpdi5zdHlsZS5vcGFjdGl5ID0gJzEnXG4gICAgfVxuXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKFwidGl0bGVcIilcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9IHRhc2suZ2V0VGl0bGUoKVxuXG4gICAgY29uc3QgbGFzdFRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBsYXN0VGFza0Rpdi5jbGFzc0xpc3QuYWRkKFwibGFzdC10YXNrLWVsZW1lbnRzXCIpO1xuXG4gICAgY29uc3QgZGV0YWlsc0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgZGV0YWlsc0J0bi50ZXh0Q29udGVudCA9ICdEZXRhaWxzJ1xuICAgIGRldGFpbHNCdG4uY2xhc3NMaXN0LmFkZCgnZGV0YWlscycpXG5cbiAgICBjb25zdCBkYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZGF0ZURpdi5jbGFzc0xpc3QuYWRkKCdkdWUtZGF0ZScpO1xuICAgIGRhdGVEaXYudGV4dENvbnRlbnQgPSB0YXNrLmdldERhdGUoKVxuXG4gICAgY29uc3QgZWRpdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBlZGl0LmNsYXNzTGlzdC5hZGQoXCJlZGl0XCIsIFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4gICAgZWRpdC50ZXh0Q29udGVudCA9ICdlZGl0JztcblxuICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcImRlbGV0ZVwiLCBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9ICdkZWxldGUnO1xuXG4gICAgZmlyc3RUYXNrRGl2LmFwcGVuZCh0aXRsZSlcbiAgICBsYXN0VGFza0Rpdi5hcHBlbmQoZGV0YWlsc0J0biwgZGF0ZURpdiwgZWRpdCwgZGVsZXRlQnRuKVxuICAgIHRhc2tEaXYuYXBwZW5kKGZpcnN0VGFza0RpdiwgbGFzdFRhc2tEaXYpXG4gICAgdGFza3NDb250YWluZXIuYXBwZW5kKHRhc2tEaXYpXG59O1xuXG5mdW5jdGlvbiB1cGRhdGVUYXNrVUkoaWQpIHtcbiAgICBjb25zdCB0YXNrRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgY29uc3QgdGFzayA9IHRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdERpdklkKS5nZXRUYXNrKGlkKVxuXG4gICAgY29uc3QgdGFza1RpdGxlID0gdGFza0Rpdi5jaGlsZE5vZGVzWzBdXG4gICAgdGFza1RpdGxlLnRleHRDb250ZW50ID0gdGFzay5nZXRUaXRsZSgpXG5cbiAgICBpZiAodGFzay5nZXRQcmlvcml0eSgpID09ICdMb3cnKSB7XG4gICAgICAgIHRhc2tEaXYuc3R5bGUuYm9yZGVyTGVmdCA9ICc1cHggc29saWQgZ3JlZW4nO1xuICAgIH0gZWxzZSBpZiAodGFzay5nZXRQcmlvcml0eSgpID09ICdNZWRpdW0nKSB7XG4gICAgICAgIHRhc2tEaXYuc3R5bGUuYm9yZGVyTGVmdCA9ICc1cHggc29saWQgb3JhbmdlJztcbiAgICB9IGVsc2Uge1xuICAgICAgICB0YXNrRGl2LnN0eWxlLmJvcmRlckxlZnQgPSAnNXB4IHNvbGlkIHJlZCc7XG4gICAgfVxuXG4gICAgaWYgKHRhc2suZ2V0U3RhdHVzKCkgPT0gJ0NvbXBsZXRlJykge1xuICAgICAgICB0YXNrRGl2LnN0eWxlLm9wYWNpdHkgPSAnMC41JztcbiAgICB9IGVsc2UgaWYgKHRhc2suZ2V0U3RhdHVzKCkgPT0gJ0luY29tcGxldGUnKSB7XG4gICAgICAgIHRhc2tEaXYuc3R5bGUub3BhY2l0eSA9ICcxJztcbiAgICB9XG4gICAgXG4gICAgY29uc3QgdGFza0R1ZURhdGUgPSB0YXNrRGl2LmNoaWxkTm9kZXNbMV0uY2hpbGROb2Rlc1sxXVxuICAgIHRhc2tEdWVEYXRlLnRleHRDb250ZW50ID0gdGFzay5nZXREYXRlKClcbiAgICBjb25zb2xlLmxvZyh0YXNrLmdldFRpdGxlKCkpXG59XG5cblxuLy8gRHluYW1pYyBUYXNrIEV2ZW50IExpc3RlbmVyc1xuXG5sZXQgdGFza0lkIC8vIHRoZSB2YXJpYWJsZSB0byBhY2Nlc3MgYSBzcGVjaWZpYyB0YXNrIGlkIGZvciBlZGl0aW5nXG5cbmNvbnN0IHRhc2tzRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrc1wiKVxudGFza3NEaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4geyAgIFxuXG4gICAgLy8gRWRpdFxuICAgIGlmIChlLnRhcmdldC5tYXRjaGVzKFwic3BhblwiKSAmJiBlLnRhcmdldC50ZXh0Q29udGVudCA9PSBcImVkaXRcIikge1xuICAgICAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWZvcm1cIik7XG4gICAgICAgIG9wZW5Gb3JtKGZvcm0pXG5cbiAgICAgICAgY29uc3QgaWQgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuaWRcbiAgICAgICAgY29uc3QgcHJvamVjdCA9IHRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdERpdklkKVxuICAgICAgICBjb25zdCB0YXNrVG9FZGl0ID0gcHJvamVjdC5nZXRUYXNrKGlkKVxuICAgICAgICBcbiAgICAgICAgdGFza0lkID0gaWRcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHRhc2tUaXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LXRpdGxlJylcbiAgICAgICAgY29uc3QgdGFza0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXQtZGVzY3JpcHRpb24nKVxuICAgICAgICBjb25zdCB0YXNrRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWR1ZS1kYXRlJylcbiAgICAgICAgY29uc3QgdGFza1ByaW9yaXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXQtcHJpb3JpdHknKVxuICAgICAgICBjb25zdCB0YXNrQ2hlY2tib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdC1zdGF0dXMnKVxuXG4gICAgICAgIHRhc2tUaXRsZS52YWx1ZSA9IHRhc2tUb0VkaXQuZ2V0VGl0bGUoKTtcbiAgICAgICAgdGFza0Rlc2NyaXB0aW9uLnZhbHVlID0gdGFza1RvRWRpdC5nZXREZXNjcmlwdGlvbigpO1xuICAgICAgICB0YXNrRGF0ZS52YWx1ZSA9IHRhc2tUb0VkaXQuZ2V0RGF0ZSgpO1xuICAgICAgICB0YXNrUHJpb3JpdHkudmFsdWUgPSB0YXNrVG9FZGl0LmdldFByaW9yaXR5KCk7XG4gICAgICAgIFxuICAgICAgICBpZiAodGFza1RvRWRpdC5nZXRTdGF0dXMoKSA9PSAnQ29tcGxldGUnKSB7XG4gICAgICAgICAgICB0YXNrQ2hlY2tib3guY2hlY2tlZCA9IHRydWVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRhc2tDaGVja2JveC5jaGVja2VkID0gZmFsc2VcbiAgICAgICAgfSAgICAgICAgXG5cbiAgICAvLyBEZWxldGUgIFxuICAgIH0gZWxzZSBpZiAoZS50YXJnZXQubWF0Y2hlcyhcInNwYW5cIikgJiYgZS50YXJnZXQudGV4dENvbnRlbnQgPT0gXCJkZWxldGVcIikge1xuICAgICAgICBjb25zdCB0YXNrID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlXG4gICAgICAgIGNvbnNvbGUubG9nKHRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdERpdklkKS5nZXRUYXNrcygpWzBdLmdldFRpdGxlKCkpXG4gICAgICAgIHRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdERpdklkKS5yZW1vdmVUYXNrKHRhc2suaWQpXG4gICAgICAgIFxuICAgICAgICB0YXNrLnJlbW92ZSgpXG4gICAgICAgIGNvbnNvbGUubG9nKHRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdERpdklkKS5nZXRUYXNrcygpKVxuICAgIFxuXG4gICAgLy8gRGV0YWlscyBCdXR0b25cbiAgICB9IGVsc2UgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoXCJidXR0b25cIikgJiYgZS50YXJnZXQudGV4dENvbnRlbnQgPT0gJ0RldGFpbHMnKSB7XG4gICAgICAgIGNvbnN0IGlkID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmlkXG4gICAgICAgIGNvbnN0IHRhc2sgPSB0b0RvTGlzdC5nZXRQcm9qZWN0KHByb2plY3REaXZJZCkuZ2V0VGFzayhpZClcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrLXRpdGxlLW91dHB1dFwiKVxuICAgICAgICBjb25zdCBkYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrLWR1ZS1kYXRlLW91dHB1dFwiKVxuICAgICAgICBjb25zdCBwcmlvcml0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFzay1wcmlvcml0eS1vdXRwdXRcIilcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrLXN0YXR1cy1vdXRwdXRcIilcbiAgICAgICAgY29uc3QgZGV0YWlscyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFzay1kZXRhaWxzLW91dHB1dFwiKVxuXG5cbiAgICAgICAgdGl0bGUudGV4dENvbnRlbnQgPSB0YXNrLmdldFRpdGxlKClcbiAgICAgICAgZGF0ZS50ZXh0Q29udGVudCA9IHRhc2suZ2V0RGF0ZSgpXG4gICAgICAgIHByaW9yaXR5LnRleHRDb250ZW50ID0gdGFzay5nZXRQcmlvcml0eSgpXG4gICAgICAgIHN0YXR1cy50ZXh0Q29udGVudCA9IHRhc2suZ2V0U3RhdHVzKClcbiAgICAgICAgZGV0YWlscy50ZXh0Q29udGVudCA9IHRhc2suZ2V0RGVzY3JpcHRpb24oKVxuXG4gICAgICAgIGNvbnN0IGRldGFpbHNNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFzay1kZXRhaWxzXCIpO1xuICAgICAgICBvcGVuRm9ybShkZXRhaWxzTW9kYWwpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBjbG9zZU1vZGFsQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1jbG9zZS1idXR0b25dXCIpXG4gICAgICAgIGNsb3NlTW9kYWxCdXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm0gPSBidXR0b24uY2xvc2VzdChcIiN0YXNrLWRldGFpbHNcIilcbiAgICAgICAgICAgICAgICBjbG9zZUZvcm0oZm9ybSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxufSk7XG5cbi8vIFRhc2sgQnV0dG9uIEZ1bmN0aW9uYWxpdHlcblxuY29uc3QgYWRkVGFza0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtdGFzaycpO1xuY29uc3QgZWRpdFRhc2tCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWRpdC10YXNrJyk7XG5cbmFkZFRhc2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIGNvbnN0IG5ld1Rhc2sgPSBjcmVhdGVUYXNrKClcbiAgICBjcmVhdGVUYXNrVUkobmV3VGFzaylcbiAgICBjb25zdCBmb3JtQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybS1jYXJkXCIpO1xuICAgIGZvcm1DYXJkLnJlc2V0KCk7XG4gICAgY29uc3QgdGFza0RhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHVlLWRhdGUnKVxuICAgIGNvbnN0IHRvZGF5RGF0ZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAxMCk7XG4gICAgdGFza0RhdGUudmFsdWUgPSB0b2RheURhdGU7XG59KVxuXG5lZGl0VGFza0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgdXBkYXRlVGFzaygpXG4gICAgdXBkYXRlVGFza1VJKHRhc2tJZClcbn0pXG5cbi8vIEluaXRpYWxpemUgRm9ybSBEZWZhdWx0c1xuY29uc3QgdGFza0RhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHVlLWRhdGUnKVxuY29uc3QgdG9kYXlEYXRlID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDEwKTtcbnRhc2tEYXRlLnZhbHVlID0gdG9kYXlEYXRlO1xuXG4vLyBJbml0aWFsaXplIFByb2plY3RcblxuY29uc3QgcHJvamVjdCA9IGNyZWF0ZVByb2plY3QoKVxucHJvamVjdC5zZXRQcm9qZWN0VGl0bGUoJ0RlZmF1bHQgUHJvamVjdCcpXG50b0RvTGlzdC5hZGRQcm9qZWN0KHByb2plY3QpXG5jb25zdCBwcm9qZWN0RGl2ID0gY3JlYXRlUHJvamVjdFVJKHByb2plY3QpXG5wcm9qZWN0RGl2SWQgPSBwcm9qZWN0LmdldFByb2plY3RJZCgpXG5wcm9qZWN0RGl2LmlkID0gcHJvamVjdERpdklkXG5wcm9qZWN0RGl2LmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKVxucHJvamVjdERpdi5zdHlsZS5jc3NUZXh0ID0gcHJvamVjdFN0eWxlIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDEzOCk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fKDY1OCk7XG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oOTgyKTtcbiJdLCJuYW1lcyI6WyJUYXNrIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJwcmlvcml0eSIsInN0YXR1cyIsImlkIiwiZ2V0VGl0bGUiLCJzZXRUaXRsZSIsIm5ld1RpdGxlIiwiZ2V0RGVzY3JpcHRpb24iLCJzZXREZXNjcmlwdGlvbiIsIm5ld0Rlc2NyaXB0aW9uIiwiZ2V0RGF0ZSIsInNldERhdGUiLCJuZXdEYXRlIiwiZ2V0UHJpb3JpdHkiLCJzZXRQcmlvcml0eSIsIm5ld1ByaW9yaXR5IiwiZ2V0U3RhdHVzIiwic2V0U3RhdHVzIiwibmV3U3RhdHVzIiwiZ2V0SWQiLCJzZXRJZCIsIm5ld0lkIiwiUHJvamVjdCIsInByb2plY3RUaXRsZSIsInByb2plY3RJZCIsInByb2plY3QiLCJnZXRUYXNrcyIsImdldFByb2plY3RUaXRsZSIsImdldFByb2plY3RJZCIsInNldFByb2plY3RUaXRsZSIsInNldFByb2plY3RJZCIsImdldFRhc2siLCJmaW5kIiwidGFzayIsImFkZFRhc2siLCJwdXNoIiwicmVtb3ZlVGFzayIsImZpbHRlciIsIlRvRG8iLCJ0b0RvIiwiZ2V0UHJvamVjdCIsImdldFByb2plY3RzIiwiYWRkUHJvamVjdCIsInJlbW92ZVByb2plY3QiLCJvcGVuTW9kYWxCdXR0b25zIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2xvc2VNb2RhbEJ1dHRvbnMiLCJvdmVybGF5IiwiZ2V0RWxlbWVudEJ5SWQiLCJvcGVuRm9ybSIsImZvcm0iLCJjbGFzc0xpc3QiLCJhZGQiLCJjbG9zZUZvcm0iLCJyZW1vdmUiLCJmb3JFYWNoIiwiYnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJkYXRhc2V0IiwibW9kYWxUYXJnZXQiLCJjbG9zZXN0IiwidG9Eb0xpc3QiLCJjcmVhdGVQcm9qZWN0IiwicHJvamVjdFRpdGxlSW5wdXQiLCJ2YWx1ZSIsInNlbGYiLCJjcnlwdG8iLCJyYW5kb21VVUlEIiwiY3JlYXRlUHJvamVjdFVJIiwicHJvamVjdHNDb250YWluZXIiLCJwcm9qZWN0RGl2IiwiY3JlYXRlRWxlbWVudCIsImFkZFByb2plY3REaXYiLCJwcm9qZWN0VGl0bGVEaXYiLCJ0ZXh0Q29udGVudCIsInR5cGUiLCJwcm9qZWN0RWRpdERpdiIsImVkaXRCdG4iLCJkZWxldGVCdG4iLCJjaGVja0J0biIsImNhbmNlbEJ0biIsImFwcGVuZCIsImluc2VydEJlZm9yZSIsImFkZFByb2plY3RCdG4iLCJzZXRQcm9qZWN0QnRuIiwiY2FuY2VsUHJvamVjdEJ0biIsInJlbmRlclByb2plY3RzVGFza3NCZXR0ZXIiLCJwcm9qZWN0RGl2SWQiLCJjcmVhdGVUYXNrVUkiLCJ0b2dnbGUiLCJuZXdQcm9qZWN0IiwicHJvamVjdHMiLCJwcm9qZWN0U3R5bGUiLCJ0YXNrSWQiLCJ0YXNrc0NvbnRhaW5lciIsInRhc2tEaXYiLCJmaXJzdFRhc2tEaXYiLCJzdHlsZSIsImJvcmRlckxlZnQiLCJvcGFjaXR5Iiwib3BhY3RpeSIsImxhc3RUYXNrRGl2IiwiZGV0YWlsc0J0biIsImRhdGVEaXYiLCJlZGl0IiwiZSIsImNvbnRhaW5zIiwicmVtb3ZlQXR0cmlidXRlIiwidGFyZ2V0IiwibWF0Y2hlcyIsImNzc1RleHQiLCJjb25zb2xlIiwibG9nIiwicGFyZW50Tm9kZSIsImNoaWxkcmVuIiwiaW5wdXQiLCJlZGl0UHJvamVjdEJ0biIsInRhc2tUb0VkaXQiLCJ0YXNrVGl0bGUiLCJ0YXNrRGVzY3JpcHRpb24iLCJ0YXNrRGF0ZSIsInRhc2tQcmlvcml0eSIsInRhc2tDaGVja2JveCIsImNoZWNrZWQiLCJkYXRlIiwiZGV0YWlscyIsImRldGFpbHNNb2RhbCIsImFkZFRhc2tCdXR0b24iLCJlZGl0VGFza0J1dHRvbiIsInByZXZlbnREZWZhdWx0IiwibmV3VGFzayIsInRhc2tTdGF0dXMiLCJjcmVhdGVUYXNrIiwicmVzZXQiLCJ0b2RheURhdGUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzbGljZSIsInVwZGF0ZVRhc2siLCJjaGlsZE5vZGVzIiwidXBkYXRlVGFza1VJIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIl0sInNvdXJjZVJvb3QiOiIifQ==